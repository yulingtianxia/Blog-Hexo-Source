---
layout: post
title: "函数指针与指针函数"
date: 2014-04-17 19:24:39 +0800
comments: true
tags: 
- 转载
- C

---
本文摘自[周立功](http://blog.sina.com.cn/s/blog_5e8facd20100qn20.html)  

<!--more-->
##定义
顾名思义，指针函数即返回指针的函数。其一般定义形式如下：  

       类型名 *函数名(函数参数表列);  

其中，后缀运算符括号“()”表示这是一个函数，其前缀运算符星号“*”表示此函数为指针型函数，其函数值为指针，即它带回来的值的类型为指针，当调用这个函数后，将得到一个“指向返回值为…的指针（地址），“类型名”表示函数返回的指针指向的类型”。  

 “(函数参数表列)”中的括号为函数调用运算符，在调用语句中，即使函数不带参数，其参数表的一对括号也不能省略。其示例如下：    
    
``` 
    int *pfun(int, int);
```   

由于“*”的优先级低于“()”的优先级，因而pfun首先和后面的“()”结合，也就意味着，pfun是一个函数。即：
    
``` 
    int *(pfun(int, int));
``` 
接着再和前面的“\*”结合，说明这个函数的返回值是一个指针。由于前面还有一个int，也就是说，pfun是一个返回值为整型指针的函数。  
我们不妨来再看一看，指针函数与函数指针有什么区别？

``` 
    int (*pfun)(int, int);
``` 
通过括号强行将pfun首先与“*”结合，也就意味着，pfun是一个指针，接着与后面的“()”结合，说明该指针指向的是一个函数，然后再与前面的int结合，也就是说，该函数的返回值是int。由此可见，pfun是一个指向返回值为int的函数的指针。  

虽然它们只有一个括号的差别，但是表示的意义却截然不同。函数指针的本身是一个指针，指针指向的是一个函数。指针函数的本身是一个函数，其函数的返回值是一个指针。
##用函数指针作为指针函数的返回值
在上面提到的指针函数里面，有这样一类函数，它们也返回指针型数据（地址），但是这个指针不是指向int、char之类的基本类型，而是指向函数。对于初学者，别说写出这样的函数声明，就是看到这样的写法也是一头雾水。比如,下面的语句：

``` 
int (*ff(int))(int *, int);
``` 
我们用上面介绍的方法分析一下，ff首先与后面的“()”结合，即：  

``` 
int (*(ff(int)))(int *, int);// 用括号将ff(int)再括起来也就意味着，ff是一个函数。
``` 
接着与前面的“*”结合，说明ff函数的返回值是一个指针。然后再与后面的“()”结合，也就是说，该指针指向的是一个函数。  

这种写法确实让人非常难懂，以至于一些初学者产生误解，认为写出别人看不懂的代码才能显示自己水平高。而事实上恰好相反，能否写出通俗易懂的代码是衡量程序员是否优秀的标准。一般来说，用typedef关键字会使该声明更简单易懂。在前面我们已经见过：  

``` 
int (*PF)(int *, int);
``` 
也就是说，PF是一个函数指针“变量”。当使用typedef声明后，则PF就成为了一个函数指针“类型”，即：  

``` 
typedef int (*PF)(int *, int);
``` 
这样就定义了返回值的类型。然后，再用PF作为返回值来声明函数: 

``` 
PF ff(int);
``` 